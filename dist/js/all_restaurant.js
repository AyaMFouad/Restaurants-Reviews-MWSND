class DBHelper{static get DATABASE_URL(){return"http://localhost:1337"}static get RESTAURANT_URL(){return"http://localhost:1337/restaurants"}static get REVIEWS_URL(){return"http://localhost:1337/reviews/?restaurant_id="}static openDatabase(){return navigator.serviceWorker?idb.open("restaurants-db",1,function(e){e.createObjectStore("restaurants",{keyPath:"id"}).createIndex("rest-id","id"),e.createObjectStore("reviews",{keyPath:"id",autoIncrement:!0}).createIndex("restaurant_id","restaurant_id",{unique:!1}),e.createObjectStore("sync-reviews",{keyPath:"id",autoIncrement:!0}).createIndex("restaurant_id","restaurant_id",{unique:!1})}):(console.log("Browser doesn't support Service Workers"),Promise.resolve())}static fetchRestaurants(e){DBHelper.openDatabase().then(function(e){return e?e.transaction("restaurants","readwrite").objectStore("restaurants").getAll():void 0}).then(function(t){0!==t.length&&e(null,t)}),fetch(DBHelper.RESTAURANT_URL).then(function(t){200===t.status?t.json().then(function(t){DBHelper.openDatabase().then(function(e){if(e){let n=e.transaction("restaurants","readwrite"),r=n.objectStore("restaurants");return t.forEach(function(e){r.put(e)}),n.complete}}),e(null,t)}):console.log("Fetch Issue - Status Code: "+t.status)}).catch(function(e){console.log("Fetch Error: ",e)})}static fetchRestaurantById(e,t){DBHelper.fetchRestaurants((n,r)=>{if(n)t(n,null);else{const n=r.find(t=>t.id==e);n?t(null,n):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){DBHelper.fetchRestaurants((n,r)=>{if(n)t(n,null);else{const n=r.filter(t=>t.cuisine_type==e);t(null,n)}})}static fetchRestaurantByNeighborhood(e,t){DBHelper.fetchRestaurants((n,r)=>{if(n)t(n,null);else{const n=r.filter(t=>t.neighborhood==e);t(null,n)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,n){DBHelper.fetchRestaurants((r,a)=>{if(r)n(r,null);else{let r=a;"all"!=e&&(r=r.filter(t=>t.cuisine_type==e)),"all"!=t&&(r=r.filter(e=>e.neighborhood==t)),n(null,r)}})}static fetchNeighborhoods(e){DBHelper.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].neighborhood),r=t.filter((e,n)=>t.indexOf(e)==n);e(null,r)}})}static fetchCuisines(e){DBHelper.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].cuisine_type),r=t.filter((e,n)=>t.indexOf(e)==n);e(null,r)}})}static fetchReviews(e,t){DBHelper.openDatabase().then(function(t){if(t){return t.transaction("reviews","readwrite").objectStore("reviews").index("restaurant_id").getAll(parseInt(e))}}).then(function(e){0!==e.length&&t(null,e)}),fetch(`${DBHelper.REVIEWS_URL}${e}`).then(e=>e.json()).then(e=>{DBHelper.openDatabase().then(function(t){if(t){let n=t.transaction("reviews","readwrite"),r=n.objectStore("reviews");return e.forEach(function(e){r.put(e)}),n.complete}}),t(null,e)}).catch(e=>t(`Request failed. Returned ${e}`,null))}static fetchOfflineReviews(e,t){DBHelper.openDatabase().then(function(t){if(t){return t.transaction("sync-reviews","readonly").objectStore("sync-reviews").index("restaurant_id").getAll(parseInt(e))}}).then(function(e){0!==e.length&&t(null,e)})}static postReview(e){return DBHelper.openDatabase().then(function(t){if(t){let n=t.transaction("sync-reviews","readwrite");return n.objectStore("sync-reviews").put(e),n.complete}}).then(function(){return Promise.resolve()}).catch(function(e){return console.log(e),Promise.resolve()})}static toggleFavorite(e,t){return DBHelper.openDatabase().then(function(e){if(e){return e.transaction("restaurants","readwrite").objectStore("restaurants").index("rest-id").openCursor()}}).then(function n(r){if(e=+e,r){if(r.value.id===e){var a=r.value;a.is_favorite=t,r.update(a).onsuccess=function(){}}return r.continue().then(n)}}).then(function(){fetch(`http://localhost:1337/restaurants/${e}/?is_favorite=${t}`,{method:"PUT"}).then(e=>e.json()).catch(e=>{console.log("Error fetching is_favorite: "+e)})}).then(function(){return Promise.resolve()})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e){return`/img/${e.photograph}.webp`}static imageResponsiveUrlForRestaurant(e){return`/img_responsive/${e.id}-320.webp 320w,\n        /img_responsive/${e.id}-480.webp 480w,\n        /img_responsive/${e.id}-640.webp 640w,\n        /img_responsive/${e.id}-800.webp 800w`}static mapMarkerForRestaurant(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:DBHelper.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}}let restaurant;var map;const photographAlts={1:"Sereval groups of people having quality time at a restaurant.",2:"A lovely margeritta pizza",3:"An empty restaurant setting which has heaters",4:"A corner shot of the outside of the restaurat.",5:"A crowded restaurant and staff serving food from behind the bar.",6:"Restaurant with wooden tables, charis, and a US flag as a wall decoration",7:"a dog watching from the outside of a crowded burger shop, accompanied by two men.",8:"Close up of the dutch restaurant logo beside a flowering tree",9:"Black and white picture of people eating at an asian restaurat.",10:"Empty restaurant's white chairs, walls and ceilings."};window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}),callMap=document.getElementById("mapToggle").addEventListener("click",function(e){"block"===document.getElementById("map-container").style.display?(document.getElementById("map-container").style.display="none",window.initMap()):document.getElementById("map-container").style.display="block"}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),toggleFavorite=(e=>{const t=document.getElementById("isFavorite"),n=t.classList.contains("far");t.classList.toggle("far"),t.classList.toggle("fas"),DBHelper.toggleFavorite(e,n)}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name;const t=document.getElementById("isFavorite"),n="true"==e.is_favorite?"fas":"far";t.classList.remove("far"),t.classList.add(`${n}`),"true"==e.is_favorite?t.setAttribute("aria-label",`Unmark ${e.name} as favorite`):t.setAttribute("aria-label",`Mark ${e.name} as favorite`),document.getElementById("restaurant-address").innerHTML=e.address;const r=document.getElementById("restaurant-img");r.className="restaurant-img",r.src=DBHelper.imageUrlForRestaurant(e),r.srcset=DBHelper.imageResponsiveUrlForRestaurant(e),r.alt=photographAlts[e.id],document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");t.innerHTML="";for(let n in e){const r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);const i=document.createElement("td");i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}}),fillReviewsHTML=((e=self.restaurant.id)=>{DBHelper.fetchReviews(e,(e,t)=>{if(e)console.log(e);else{const e=document.getElementById("reviews-container");e.innerHTML='<ul id="reviews-list"></ul>';const n=document.createElement("h2");if(n.innerHTML="Reviews",n.tabIndex="0",e.appendChild(n),!t){const t=document.createElement("p");return t.innerHTML="No reviews yet!",void e.appendChild(t)}{const n=document.getElementById("reviews-list");t.forEach(e=>{n.appendChild(createReviewHTML(e))}),e.appendChild(n),offlineReviewsHTML()}}})}),window.addEventListener("online",function(e){navigator.serviceWorker.ready.then(function(e){e.sync.register("reqReviewSync")})},!1),offlineReviewsHTML=((e=self.restaurant.id)=>{DBHelper.fetchOfflineReviews(e,(e,t)=>{if(e)console.log(e);else{const e=document.getElementById("reviews-list");0===document.getElementsByClassName("tmp").length&&t.forEach(t=>{e.appendChild(createTmpReviewHTML(t))})}})}),createReviewHTML=(e=>{const t=document.createElement("li");t.tabIndex="0";const n=document.createElement("h5"),r=new Date(e.createdAt);n.innerHTML=r.toDateString(),t.appendChild(n);const a=document.createElement("h1");a.innerHTML=e.name,t.appendChild(a);const i=document.createElement("i");i.innerHTML=`Rating: ${e.rating}`,i.style.backgroundColor=5===e.rating?"green":e.rating>2?"orange":"red",t.appendChild(i);const o=document.createElement("p");o.innerHTML=e.comments,t.appendChild(o);const s=`${e.name} said ${e.comments} and rated the restaurant ${e.rating} out of 5`;return t.setAttribute("aria-label",s),t}),createTmpReviewHTML=(e=>{const t=document.createElement("li");t.setAttribute("class","tmp");const n=document.createElement("div");n.setAttribute("class","review-header"),t.appendChild(n);const r=document.createElement("h1");r.setAttribute("class","reviewName"),r.innerHTML=e.name,n.appendChild(r);const a=document.createElement("h5");a.setAttribute("class","reviewDate");a.innerHTML=new Date(e.createdAt).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),n.appendChild(a);const i=document.createElement("i");i.innerHTML=`Rating: ${e.rating}`,i.setAttribute("class","reviewRating"),i.style.backgroundColor=5===e.rating?"green":e.rating>2?"orange":"red",t.appendChild(i);const o=document.createElement("p");return o.innerHTML=e.comments,o.setAttribute("class","reviewComment"),t.appendChild(o),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=t.querySelectorAll("li");for(element of n)element.removeAttribute("aria-current");const r=document.createElement("li");r.setAttribute("aria-current","page"),2!==t.childElementCount&&(r.innerHTML=e.name,t.appendChild(r))}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});const fav=document.getElementById("isFavorite");fav.addEventListener("click",()=>{toggleFavorite(self.restaurant.id)}),fav.addEventListener("keydown",e=>{13===e.keyCode&&toggleFavorite(self.restaurant.id)}),navigator.serviceWorker&&navigator.serviceWorker.register("sw.js").then(()=>console.log("Passed Test")),registerServiceWorker=(()=>{navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").catch(function(){console.log("Something went wrong. ServiceWorker not registered")})}),registerServiceWorker();var vue=new Vue({el:"#app",data:{formOpen:!1,review:{name:"",rating:"",comments:""}},methods:{resetForm:function(){this.review={name:"",rating:"",comments:""}},cancel:function(){this.formOpen=!1,this.resetForm()}}});addReview=(()=>{const e={restaurant_id:self.restaurant.id,name:document.getElementById("name").value,createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),rating:+document.getElementById("rating").value,comments:document.getElementById("comments").value},t=document.getElementById("reviews-list");t.insertBefore(createReviewHTML(e),t.childNodes[0]),navigator.onLine||alert("You are currently offline. Your review will be posted once you are online again. Thank you for reviewing!"),DBHelper.postReview(e).then(function(){navigator.serviceWorker.ready.then(function(e){e.sync.register("reqReviewSync"),location.reload()})}).then(function(){fillReviewsHTML()}).then(function(){offlineReviewsHTML()}).catch(function(e){console.error(e)})}),document.getElementById("review-form").addEventListener("submit",function(e){e.preventDefault(),addReview(),13===e.keyCode&&(document.getElementById("submit").click(),document.getElementById("name").tabIndex="-1",document.getElementById("rating").tabIndex="-1",document.getElementById("comments").tabIndex="-1",document.getElementById("submit").tabIndex="-1",document.getElementById("cancel").tabIndex="-1")}),document.getElementById("add-review").addEventListener("keyup",function(e){e.preventDefault(),13===e.keyCode&&(document.getElementById("name").tabIndex="0",document.getElementById("rating").tabIndex="0",document.getElementById("comments").tabIndex="0",document.getElementById("submit").tabIndex="0",document.getElementById("cancel").tabIndex="0",document.getElementById("add-review").click())}),document.getElementById("cancel").addEventListener("keyup",function(e){e.preventDefault(),13===e.keyCode&&(document.getElementById("cancel").click(),document.getElementById("name").tabIndex="-1",document.getElementById("rating").tabIndex="-1",document.getElementById("comments").tabIndex="-1",document.getElementById("submit").tabIndex="-1",document.getElementById("cancel").tabIndex="-1")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiaGVscGVyLmpzIiwicmVzdGF1cmFudF9pbmZvLmpzIiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyLmpzIiwiZm9ybS5qcyJdLCJuYW1lcyI6WyJEQkhlbHBlciIsIkRBVEFCQVNFX1VSTCIsIlJFU1RBVVJBTlRfVVJMIiwiUkVWSUVXU19VUkwiLCJbb2JqZWN0IE9iamVjdF0iLCJuYXZpZ2F0b3IiLCJzZXJ2aWNlV29ya2VyIiwiaWRiIiwib3BlbiIsInVwZ3JhZGVEYiIsImNyZWF0ZU9iamVjdFN0b3JlIiwia2V5UGF0aCIsImNyZWF0ZUluZGV4IiwiYXV0b0luY3JlbWVudCIsInVuaXF1ZSIsImNvbnNvbGUiLCJsb2ciLCJQcm9taXNlIiwicmVzb2x2ZSIsImNhbGxiYWNrIiwib3BlbkRhdGFiYXNlIiwidGhlbiIsImRiIiwidHJhbnNhY3Rpb24iLCJvYmplY3RTdG9yZSIsImdldEFsbCIsInJlc3RhdXJhbnRzIiwibGVuZ3RoIiwiZmV0Y2giLCJyZXNwb25zZSIsInN0YXR1cyIsImpzb24iLCJ0eCIsInN0b3JlUmVzdGF1cmFudHMiLCJmb3JFYWNoIiwicmVzdGF1cmFudCIsInB1dCIsImNvbXBsZXRlIiwiY2F0Y2giLCJlcnIiLCJpZCIsImZldGNoUmVzdGF1cmFudHMiLCJlcnJvciIsImZpbmQiLCJyIiwiY3Vpc2luZSIsInJlc3VsdHMiLCJmaWx0ZXIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJuZWlnaGJvcmhvb2RzIiwibWFwIiwidiIsImkiLCJ1bmlxdWVOZWlnaGJvcmhvb2RzIiwiaW5kZXhPZiIsImN1aXNpbmVzIiwidW5pcXVlQ3Vpc2luZXMiLCJpbmRleCIsInBhcnNlSW50IiwicmV2aWV3cyIsInN0b3JlUmV2aWV3cyIsInJldmlldyIsInJlc3RhdXJhbnRJZCIsInRvZ2dsZVZhbHVlIiwib3BlbkN1cnNvciIsInVwZGF0ZUZhdm9yaXRlIiwiY3Vyc29yIiwidmFsdWUiLCJ1cGRhdGVEYXRhIiwiaXNfZmF2b3JpdGUiLCJ1cGRhdGUiLCJvbnN1Y2Nlc3MiLCJjb250aW51ZSIsIm1ldGhvZCIsInBob3RvZ3JhcGgiLCJnb29nbGUiLCJtYXBzIiwiTWFya2VyIiwicG9zaXRpb24iLCJsYXRsbmciLCJ0aXRsZSIsIm5hbWUiLCJ1cmwiLCJ1cmxGb3JSZXN0YXVyYW50IiwiYW5pbWF0aW9uIiwiQW5pbWF0aW9uIiwiRFJPUCIsInBob3RvZ3JhcGhBbHRzIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCI2IiwiNyIsIjgiLCI5IiwiMTAiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCIsInNlbGYiLCJNYXAiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiem9vbSIsImNlbnRlciIsInNjcm9sbHdoZWVsIiwiZmlsbEJyZWFkY3J1bWIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiY2FsbE1hcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInN0eWxlIiwiZGlzcGxheSIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJ0b2dnbGVGYXZvcml0ZSIsInJlc3RJZCIsImVsZW1lbnQiLCJzZXRUb2dnbGUiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInRvZ2dsZSIsImlubmVySFRNTCIsImZhdm9yaXRlIiwiaXNGYXZvcml0ZSIsInJlbW92ZSIsImFkZCIsInNldEF0dHJpYnV0ZSIsImFkZHJlc3MiLCJpbWFnZSIsImNsYXNzTmFtZSIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsInNyY3NldCIsImltYWdlUmVzcG9uc2l2ZVVybEZvclJlc3RhdXJhbnQiLCJhbHQiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJjcmVhdGVFbGVtZW50IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwiZmV0Y2hSZXZpZXdzIiwiY29udGFpbmVyIiwidGFiSW5kZXgiLCJub1Jldmlld3MiLCJ1bCIsImNyZWF0ZVJldmlld0hUTUwiLCJvZmZsaW5lUmV2aWV3c0hUTUwiLCJlIiwicmVhZHkiLCJyZWdzdyIsInN5bmMiLCJyZWdpc3RlciIsImZldGNoT2ZmbGluZVJldmlld3MiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiY3JlYXRlVG1wUmV2aWV3SFRNTCIsImxpIiwiZGF0ZSIsIm15X2RhdGUiLCJEYXRlIiwiY3JlYXRlZEF0IiwidG9EYXRlU3RyaW5nIiwicmF0aW5nIiwiYmFja2dyb3VuZENvbG9yIiwiY29tbWVudHMiLCJsYWJlbCIsImRpdiIsInRvTG9jYWxlRGF0ZVN0cmluZyIsIndlZWtkYXkiLCJ5ZWFyIiwibW9udGgiLCJicmVhZGNydW1iIiwiYnJlYWRjcnVtYkVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbW92ZUF0dHJpYnV0ZSIsImNoaWxkRWxlbWVudENvdW50IiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsIlJlZ0V4cCIsImV4ZWMiLCJkZWNvZGVVUklDb21wb25lbnQiLCJmYXYiLCJrZXlDb2RlIiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwidnVlIiwiVnVlIiwiZWwiLCJkYXRhIiwiZm9ybU9wZW4iLCJtZXRob2RzIiwicmVzZXRGb3JtIiwidGhpcyIsImNhbmNlbCIsImFkZFJldmlldyIsInJlc3RhdXJhbnRfaWQiLCJnZXRUaW1lIiwidXBkYXRlZEF0IiwiaW5zZXJ0QmVmb3JlIiwiY2hpbGROb2RlcyIsIm9uTGluZSIsImFsZXJ0IiwicG9zdFJldmlldyIsInJlbG9hZCIsInByZXZlbnREZWZhdWx0IiwiY2xpY2siXSwibWFwcGluZ3MiOiJNQUdNQSxTQU1KQywwQkFFRSxNQUFRLHdCQUVWQyw0QkFFQSxNQUFRLG9DQUdWQyx5QkFFRSxNQUFRLGdEQU1WQyxzQkFJRSxPQUFLQyxVQUFVQyxjQUtSQyxJQUFJQyxLQUFLLGlCQUFrQixFQUFHLFNBQVVDLEdB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N0NqRCxTQUFTQyxlQUFlLFlBQVlnRCxTQUFXLEtBQy9DakQsU0FBU0MsZUFBZSxVQUFVZ0QsU0FBVyxLQUM3Q2pELFNBQVNDLGVBQWUsVUFBVWdELFNBQVciLCJmaWxlIjoiYWxsX3Jlc3RhdXJhbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXHJcbiAqL1xyXG5jbGFzcyBEQkhlbHBlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIERhdGFiYXNlIFVSTC5cclxuICAgKiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgICovXHJcbiAgc3RhdGljIGdldCBEQVRBQkFTRV9VUkwoKSB7XHJcbiAgICBjb25zdCBwb3J0ID0gMTMzNztcclxuICAgIHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9YDtcclxuICB9XHJcbiAgc3RhdGljIGdldCBSRVNUQVVSQU5UX1VSTCgpIHtcclxuICBjb25zdCBwb3J0ID0gMTMzNztcclxuICByZXR1cm4gYGh0dHA6Ly9sb2NhbGhvc3Q6JHtwb3J0fS9yZXN0YXVyYW50c2A7XHJcbn1cclxuXHJcbnN0YXRpYyBnZXQgUkVWSUVXU19VUkwoKSB7XHJcbiAgY29uc3QgcG9ydCA9IDEzMzc7XHJcbiAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0vcmV2aWV3cy8/cmVzdGF1cmFudF9pZD1gO1xyXG59XHJcblxyXG4vLyBJREIgY3JlYXRpb25cclxuXHJcblxyXG5zdGF0aWMgb3BlbkRhdGFiYXNlICgpIHtcclxuXHJcbiAgLy8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IHNlcnZpY2Ugd29ya2VyLFxyXG4gIC8vIHdlIGRvbid0IGNhcmUgYWJvdXQgaGF2aW5nIGEgZGF0YWJhc2VcclxuICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgQnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgU2VydmljZSBXb3JrZXJzYCk7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gaWRiLm9wZW4oJ3Jlc3RhdXJhbnRzLWRiJywgMSwgZnVuY3Rpb24gKHVwZ3JhZGVEYikge1xyXG4gICAgdmFyIHN0b3JlUmVzdGF1cmFudHMgPSB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJywge1xyXG4gICAgICBrZXlQYXRoOiAnaWQnLFxyXG4gICAgfSk7XHJcbiAgICBzdG9yZVJlc3RhdXJhbnRzLmNyZWF0ZUluZGV4KCdyZXN0LWlkJywgJ2lkJyk7XHJcbiAgICB2YXIgc3RvcmVSZXZpZXdzID0gdXBncmFkZURiLmNyZWF0ZU9iamVjdFN0b3JlKCdyZXZpZXdzJywge1xyXG4gICAgICBrZXlQYXRoOiAnaWQnLFxyXG4gICAgICBhdXRvSW5jcmVtZW50OiB0cnVlLFxyXG4gICAgfSk7XHJcbiAgICBzdG9yZVJldmlld3MuY3JlYXRlSW5kZXgoJ3Jlc3RhdXJhbnRfaWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZXN0YXVyYW50X2lkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHVuaXF1ZTogZmFsc2UgfSk7XHJcbiAgICB2YXIgc3RvcmVTeW5jUmV2aWV3ID0gdXBncmFkZURiLmNyZWF0ZU9iamVjdFN0b3JlKCdzeW5jLXJldmlld3MnLCB7XHJcbiAgICAgIGtleVBhdGg6ICdpZCcsXHJcbiAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWUsXHJcbiAgICB9KTtcclxuICAgIHN0b3JlU3luY1Jldmlldy5jcmVhdGVJbmRleCgncmVzdGF1cmFudF9pZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc3RhdXJhbnRfaWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdW5pcXVlOiBmYWxzZSB9KTtcclxuICB9KTtcclxufVxyXG5cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50cyhjYWxsYmFjaykge1xyXG5cclxuICAgIC8vIGdldCByZXN0YXVyYW50cyBmcm9tIGluZGV4ZWREQlxyXG4gICAgREJIZWxwZXIub3BlbkRhdGFiYXNlKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcclxuICAgICAgaWYgKCFkYikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGRiLnRyYW5zYWN0aW9uKCdyZXN0YXVyYW50cycsICdyZWFkd3JpdGUnKVxyXG4gICAgICAgICAgICAgICAgIC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHMnKVxyXG4gICAgICAgICAgICAgICAgIC5nZXRBbGwoKTtcclxuICAgICAgfVxyXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzdGF1cmFudHMpIHtcclxuICAgICAgaWYgKHJlc3RhdXJhbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50cyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmZXRjaChEQkhlbHBlci5SRVNUQVVSQU5UX1VSTClcclxuICAgIC50aGVuKFxyXG4gICAgICBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaCBJc3N1ZSAtIFN0YXR1cyBDb2RlOiAnICsgcmVzcG9uc2Uuc3RhdHVzKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKGZ1bmN0aW9uIChyZXN0YXVyYW50cykge1xyXG5cclxuICAgICAgICAgIC8qIEFkZCByZXN0YXVyYW50cyB0byBpbmRleGVkREIgKi9cclxuICAgICAgICAgIERCSGVscGVyLm9wZW5EYXRhYmFzZSgpLnRoZW4oZnVuY3Rpb24gKGRiKSB7XHJcbiAgICAgICAgICAgIGlmICghZGIpIHtcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgbGV0IHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnRzJywgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgICAgICAgIGxldCBzdG9yZVJlc3RhdXJhbnRzID0gdHgub2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnRzJyk7XHJcblxyXG4gICAgICAgICAgICAgIHJlc3RhdXJhbnRzLmZvckVhY2goZnVuY3Rpb24gKHJlc3RhdXJhbnQpIHtcclxuICAgICAgICAgICAgICAgIHN0b3JlUmVzdGF1cmFudHMucHV0KHJlc3RhdXJhbnQpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnRzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgKVxyXG4gICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0ZldGNoIEVycm9yOiAnLCBlcnIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhIHJlc3RhdXJhbnQgYnkgaXRzIElELlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCBjYWxsYmFjaykge1xyXG4gICAgLy8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCByZXN0YXVyYW50ID0gcmVzdGF1cmFudHMuZmluZChyID0+IHIuaWQgPT0gaWQpO1xyXG4gICAgICAgIGlmIChyZXN0YXVyYW50KSB7IC8vIEdvdCB0aGUgcmVzdGF1cmFudFxyXG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XHJcbiAgICAgICAgfSBlbHNlIHsgLy8gUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgZGF0YWJhc2VcclxuICAgICAgICAgIGNhbGxiYWNrKCdSZXN0YXVyYW50IGRvZXMgbm90IGV4aXN0JywgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSB0eXBlIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50cyAgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBjdWlzaW5lIHR5cGVcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIG5laWdoYm9yaG9vZFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgY3Vpc2luZSBhbmQgYSBuZWlnaGJvcmhvb2Qgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdHMgPSByZXN0YXVyYW50cztcclxuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobmVpZ2hib3Job29kICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBuZWlnaGJvcmhvb2RcclxuICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0ubmVpZ2hib3Job29kKTtcclxuXHJcbiAgICAgICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaSk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgdW5pcXVlTmVpZ2hib3Job29kcyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIGN1aXNpbmVzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5jdWlzaW5lX3R5cGUpO1xyXG5cclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXHJcbiAgICAgICAgY29uc3QgdW5pcXVlQ3Vpc2luZXMgPSBjdWlzaW5lcy5maWx0ZXIoKHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaSk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgdW5pcXVlQ3Vpc2luZXMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAgICogRmV0Y2ggYWxsIHJldmlld3MuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmZXRjaFJldmlld3MoaWQsIGNhbGxiYWNrKSB7XHJcblxyXG4gICAgICAvLyBnZXQgcmV2aWV3cyBmcm9tIGluZGV4ZWREQlxyXG4gICAgICBEQkhlbHBlci5vcGVuRGF0YWJhc2UoKS50aGVuKGZ1bmN0aW9uIChkYikge1xyXG4gICAgICAgIGlmICghZGIpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9ICBlbHNlIHtcclxuICAgICAgICAgIGxldCBzdG9yZVJldmlld3MgPSBkYi50cmFuc2FjdGlvbigncmV2aWV3cycsICdyZWFkd3JpdGUnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9iamVjdFN0b3JlKCdyZXZpZXdzJyk7XHJcbiAgICAgICAgICBsZXQgcmVzdEluZGV4ID0gc3RvcmVSZXZpZXdzLmluZGV4KCdyZXN0YXVyYW50X2lkJyk7XHJcbiAgICAgICAgICByZXR1cm4gcmVzdEluZGV4LmdldEFsbChwYXJzZUludChpZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmV2aWV3cykge1xyXG4gICAgICAgIGlmIChyZXZpZXdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJldmlld3MpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8qIEZldGNoIHJldmlld3MgZnJvbSBuZXR3b3JrICovXHJcbiAgICAgIGZldGNoKGAke0RCSGVscGVyLlJFVklFV1NfVVJMfSR7aWR9YClcclxuICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgICAgICAgIC50aGVuKHJldmlld3MgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgIC8qIEFkZCByZXZpZXdzIHRvIGluZGV4ZWREQiAqL1xyXG4gICAgICAgICAgICAgICAgREJIZWxwZXIub3BlbkRhdGFiYXNlKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKCFkYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdHggPSBkYi50cmFuc2FjdGlvbigncmV2aWV3cycsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvcmVSZXZpZXdzID0gdHgub2JqZWN0U3RvcmUoJ3Jldmlld3MnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV2aWV3cy5mb3JFYWNoKGZ1bmN0aW9uIChyZXZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHN0b3JlUmV2aWV3cy5wdXQocmV2aWV3KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR4LmNvbXBsZXRlO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXZpZXdzKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKGBSZXF1ZXN0IGZhaWxlZC4gUmV0dXJuZWQgJHtlcnJvcn1gLCBudWxsKSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGZldGNoT2ZmbGluZVJldmlld3MoaWQsIGNhbGxiYWNrKSB7XHJcblxyXG4gICAgICAvLyBnZXQgcmV2aWV3cyBmcm9tIGluZGV4ZWREQlxyXG4gICAgICBEQkhlbHBlci5vcGVuRGF0YWJhc2UoKS50aGVuKGZ1bmN0aW9uIChkYikge1xyXG4gICAgICAgIGlmICghZGIpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9ICBlbHNlIHtcclxuICAgICAgICAgIGxldCBzdG9yZVJldmlld3MgPSBkYi50cmFuc2FjdGlvbignc3luYy1yZXZpZXdzJywgJ3JlYWRvbmx5JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vYmplY3RTdG9yZSgnc3luYy1yZXZpZXdzJyk7XHJcbiAgICAgICAgICBsZXQgcmVzdEluZGV4ID0gc3RvcmVSZXZpZXdzLmluZGV4KCdyZXN0YXVyYW50X2lkJyk7XHJcbiAgICAgICAgICByZXR1cm4gcmVzdEluZGV4LmdldEFsbChwYXJzZUludChpZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmV2aWV3cykge1xyXG4gICAgICAgIGlmIChyZXZpZXdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJldmlld3MpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFBvc3QgcmV2aWV3cyB0byBEQlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcG9zdFJldmlldyhyZXZpZXcpIHtcclxuICAgICAgcmV0dXJuIERCSGVscGVyLm9wZW5EYXRhYmFzZSgpLnRoZW4oZnVuY3Rpb24gKGRiKSB7XHJcbiAgICAgICAgaWYgKCFkYikge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsZXQgdHggPSBkYi50cmFuc2FjdGlvbignc3luYy1yZXZpZXdzJywgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgICAgbGV0IHN0b3JlUmV2aWV3cyA9IHR4Lm9iamVjdFN0b3JlKCdzeW5jLXJldmlld3MnKTtcclxuXHJcbiAgICAgICAgICBzdG9yZVJldmlld3MucHV0KHJldmlldyk7XHJcbiAgICAgICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIHRvZ2dsZUZhdm9yaXRlKHJlc3RhdXJhbnRJZCwgdG9nZ2xlVmFsdWUpIHtcclxuICByZXR1cm4gREJIZWxwZXIub3BlbkRhdGFiYXNlKCkudGhlbihmdW5jdGlvbiAoZGIpIHtcclxuICAgIGlmICghZGIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGV0IHN0b3JlUmVzdGF1cmFudHMgPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudHMnLCAncmVhZHdyaXRlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vYmplY3RTdG9yZSgncmVzdGF1cmFudHMnKTtcclxuICAgICAgbGV0IHJlc3RhdXJhbnRJbmRleCA9IHN0b3JlUmVzdGF1cmFudHMuaW5kZXgoJ3Jlc3QtaWQnKTtcclxuICAgICAgcmV0dXJuIHJlc3RhdXJhbnRJbmRleC5vcGVuQ3Vyc29yKCk7XHJcbiAgICB9XHJcbiAgfSkudGhlbihmdW5jdGlvbiB1cGRhdGVGYXZvcml0ZShjdXJzb3IpIHtcclxuXHJcbiAgICByZXN0YXVyYW50SWQgPSArcmVzdGF1cmFudElkO1xyXG5cclxuICAgIGlmICghY3Vyc29yKSByZXR1cm47XHJcblxyXG4gICAgaWYgKGN1cnNvci52YWx1ZS5pZCA9PT0gcmVzdGF1cmFudElkKSB7XHJcbiAgICAgIHZhciB1cGRhdGVEYXRhID0gY3Vyc29yLnZhbHVlO1xyXG5cclxuICAgICAgdXBkYXRlRGF0YS5pc19mYXZvcml0ZSA9IHRvZ2dsZVZhbHVlO1xyXG4gICAgICB2YXIgcmVxdWVzdCA9IGN1cnNvci51cGRhdGUodXBkYXRlRGF0YSk7XHJcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGN1cnNvci5jb250aW51ZSgpLnRoZW4odXBkYXRlRmF2b3JpdGUpO1xyXG5cclxuICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vbG9jYWxob3N0OjEzMzcvcmVzdGF1cmFudHMvJHtyZXN0YXVyYW50SWR9Lz9pc19mYXZvcml0ZT0ke3RvZ2dsZVZhbHVlfWA7XHJcblxyXG4gICAgICBmZXRjaCh1cmwsIHtcclxuICAgICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpXHJcbiAgICAgICkuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIGZldGNoaW5nIGlzX2Zhdm9yaXRlOiAnICsgZXJyb3IpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBwYWdlIFVSTC5cclxuICAgKi9cclxuICBzdGF0aWMgdXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICByZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cclxuICAgKi9cclxuICBzdGF0aWMgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAoYC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9LndlYnBgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiBSZXN0YXVyYW50IHJlc3BvbnNpdmUgaW1hZ2VzIHNvdXJjZSBzZXQuXHJcbiAqL1xyXG5zdGF0aWMgaW1hZ2VSZXNwb25zaXZlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XHJcbiAgICBjb25zdCBzY2FsZTF4ID0gJzMyMCc7XHJcbiAgICBjb25zdCBzY2FsZTFfNXggPSAnNDgwJztcclxuICAgIGNvbnN0IHNjYWxlMnggPSAnNjQwJztcclxuICAgIGNvbnN0IHNjYWxlM3ggPSAnODAwJztcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIGAvaW1nX3Jlc3BvbnNpdmUvJHtyZXN0YXVyYW50LmlkfS0ke3NjYWxlMXh9LndlYnAgJHtzY2FsZTF4fXcsXHJcbiAgICAgICAgL2ltZ19yZXNwb25zaXZlLyR7cmVzdGF1cmFudC5pZH0tJHtzY2FsZTFfNXh9LndlYnAgJHtzY2FsZTFfNXh9dyxcclxuICAgICAgICAvaW1nX3Jlc3BvbnNpdmUvJHtyZXN0YXVyYW50LmlkfS0ke3NjYWxlMnh9LndlYnAgJHtzY2FsZTJ4fXcsXHJcbiAgICAgICAgL2ltZ19yZXNwb25zaXZlLyR7cmVzdGF1cmFudC5pZH0tJHtzY2FsZTN4fS53ZWJwICR7c2NhbGUzeH13YCk7XHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxyXG4gICAqL1xyXG4gIHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xyXG4gICAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgIHBvc2l0aW9uOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgdGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgdXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxyXG4gICAgICBtYXA6IG1hcCxcclxuICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUCxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG1hcmtlcjtcclxuICB9XHJcblxyXG59XHJcbiIsImxldCByZXN0YXVyYW50O1xyXG52YXIgbWFwO1xyXG5cclxuLypcclxuU2V0dGluZyBwaG90b2dyYXBocyBhbHRzKi9cclxuXHJcbmNvbnN0IHBob3RvZ3JhcGhBbHRzID0ge1xyXG5cdDE6IFwiU2VyZXZhbCBncm91cHMgb2YgcGVvcGxlIGhhdmluZyBxdWFsaXR5IHRpbWUgYXQgYSByZXN0YXVyYW50LlwiLFxyXG5cdDI6IFwiQSBsb3ZlbHkgbWFyZ2VyaXR0YSBwaXp6YVwiLFxyXG5cdDM6IFwiQW4gZW1wdHkgcmVzdGF1cmFudCBzZXR0aW5nIHdoaWNoIGhhcyBoZWF0ZXJzXCIsXHJcblx0NDogXCJBIGNvcm5lciBzaG90IG9mIHRoZSBvdXRzaWRlIG9mIHRoZSByZXN0YXVyYXQuXCIsXHJcblx0NTogXCJBIGNyb3dkZWQgcmVzdGF1cmFudCBhbmQgc3RhZmYgc2VydmluZyBmb29kIGZyb20gYmVoaW5kIHRoZSBiYXIuXCIsXHJcblx0NjogXCJSZXN0YXVyYW50IHdpdGggd29vZGVuIHRhYmxlcywgY2hhcmlzLCBhbmQgYSBVUyBmbGFnIGFzIGEgd2FsbCBkZWNvcmF0aW9uXCIsXHJcblx0NzogXCJhIGRvZyB3YXRjaGluZyBmcm9tIHRoZSBvdXRzaWRlIG9mIGEgY3Jvd2RlZCBidXJnZXIgc2hvcCwgYWNjb21wYW5pZWQgYnkgdHdvIG1lbi5cIixcclxuXHQ4OiBcIkNsb3NlIHVwIG9mIHRoZSBkdXRjaCByZXN0YXVyYW50IGxvZ28gYmVzaWRlIGEgZmxvd2VyaW5nIHRyZWVcIixcclxuXHQ5OiBcIkJsYWNrIGFuZCB3aGl0ZSBwaWN0dXJlIG9mIHBlb3BsZSBlYXRpbmcgYXQgYW4gYXNpYW4gcmVzdGF1cmF0LlwiLFxyXG5cdDEwOiBcIkVtcHR5IHJlc3RhdXJhbnQncyB3aGl0ZSBjaGFpcnMsIHdhbGxzIGFuZCBjZWlsaW5ncy5cIlxyXG59O1xyXG5cclxuXHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xyXG4gICAgICAgIHpvb206IDE2LFxyXG4gICAgICAgIGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXHJcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xyXG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuU2hvdyBtYXAgYnV0dG9uXHJcbiovXHJcbmNhbGxNYXAgPVxyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwVG9nZ2xlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xyXG4gIGlmICgoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1jb250YWluZXInKS5zdHlsZS5kaXNwbGF5KSA9PT0gJ2Jsb2NrJykge1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1jb250YWluZXInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgd2luZG93LmluaXRNYXAoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1jb250YWluZXInKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICB9XHJcbn0pO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcclxuICAgIGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudClcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcclxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogZmF2b3JpdGUgcmVzdGF1cmFudCBidXNpbmVzc1xyXG4gKi9cclxudG9nZ2xlRmF2b3JpdGUgPSAocmVzdElkKSA9PiB7XHJcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpc0Zhdm9yaXRlJyk7XHJcbiAgY29uc3Qgc2V0VG9nZ2xlID0gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2ZhcicpO1xyXG4gIGVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnZmFyJyk7XHJcbiAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdmYXMnKTtcclxuICBEQkhlbHBlci50b2dnbGVGYXZvcml0ZShyZXN0SWQsIHNldFRvZ2dsZSk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcblx0Y29uc3QgZmF2b3JpdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaXNGYXZvcml0ZScpO1xyXG5cdGNvbnN0IGlzRmF2b3JpdGUgPSByZXN0YXVyYW50LmlzX2Zhdm9yaXRlID09ICd0cnVlJyA/ICdmYXMnIDogJ2Zhcic7XHJcblx0ZmF2b3JpdGUuY2xhc3NMaXN0LnJlbW92ZSgnZmFyJyk7XHJcblx0ZmF2b3JpdGUuY2xhc3NMaXN0LmFkZChgJHtpc0Zhdm9yaXRlfWApO1xyXG5cdGlmIChyZXN0YXVyYW50LmlzX2Zhdm9yaXRlID09ICd0cnVlJykge1xyXG5cdGZhdm9yaXRlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBVbm1hcmsgJHtyZXN0YXVyYW50Lm5hbWV9IGFzIGZhdm9yaXRlYCk7XHJcblx0fSBlbHNlIHtcclxuXHRmYXZvcml0ZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgTWFyayAke3Jlc3RhdXJhbnQubmFtZX0gYXMgZmF2b3JpdGVgKTtcclxuXHR9XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJ1xyXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuXHRpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVJlc3BvbnNpdmVVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGltYWdlLmFsdCA9IHBob3RvZ3JhcGhBbHRzW3Jlc3RhdXJhbnQuaWRdO1xyXG5cclxuICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xyXG4gIGN1aXNpbmUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGU7XHJcblxyXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXHJcbiAgaWYgKHJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XHJcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xyXG4gIH1cclxuICAvLyBmaWxsIHJldmlld3NcclxuICBmaWxsUmV2aWV3c0hUTUwoKTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XHJcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xyXG5cdGhvdXJzLmlubmVySFRNTCA9ICcnO1xyXG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xyXG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcclxuXHJcbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgZGF5LmlubmVySFRNTCA9IGtleTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xyXG5cclxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xyXG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xyXG5cclxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuZmlsbFJldmlld3NIVE1MID0gKHJlc3RhdXJhbnRJZCA9IHNlbGYucmVzdGF1cmFudC5pZCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoUmV2aWV3cyhyZXN0YXVyYW50SWQsIChlcnJvciwgcmV2aWV3cykgPT4ge1xyXG4gICAgaWYoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XHJcbiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnPHVsIGlkPVwicmV2aWV3cy1saXN0XCI+PC91bD4nO1xyXG4gICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgICAgIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcclxuICAgICAgdGl0bGUudGFiSW5kZXggPSAnMCc7XHJcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcblxyXG4gICAgICBpZiAoIXJldmlld3MpIHtcclxuICAgICAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XHJcbiAgICAgIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xyXG4gICAgICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xyXG4gICAgICBvZmZsaW5lUmV2aWV3c0hUTUwoKTtcclxuICAgIH1cclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvbmxpbmUnLCBmdW5jdGlvbiAoZSkge1xyXG4gIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5LnRoZW4oZnVuY3Rpb24gKHJlZ3N3KSB7XHJcbiAgICByZWdzdy5zeW5jLnJlZ2lzdGVyKCdyZXFSZXZpZXdTeW5jJyk7XHJcbiAgfSk7XHJcbn0sIGZhbHNlKTtcclxuXHJcbi8vc3RvcmluZyByZXZpZXdzIHBvc3RlZCBvZmZsaW5lXHJcblxyXG5vZmZsaW5lUmV2aWV3c0hUTUwgPSAocmVzdGF1cmFudElkID0gc2VsZi5yZXN0YXVyYW50LmlkKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hPZmZsaW5lUmV2aWV3cyhyZXN0YXVyYW50SWQsIChlcnJvciwgcmV2aWV3cykgPT4ge1xyXG5cclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcclxuICAgICAgY29uc3QgdG1wcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RtcCcpO1xyXG4gICAgICBpZiAodG1wcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcclxuICAgICAgICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVRtcFJldmlld0hUTUwocmV2aWV3KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS50YWJJbmRleCA9ICcwJztcclxuXHJcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2g1Jyk7XHJcbiAgY29uc3QgbXlfZGF0ZSA9IG5ldyBEYXRlKHJldmlldy5jcmVhdGVkQXQpO1xyXG4gIGRhdGUuaW5uZXJIVE1MID0gbXlfZGF0ZS50b0RhdGVTdHJpbmcoKTtcclxuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcclxuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcclxuXHJcbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xyXG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcclxuXHRyYXRpbmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcmV2aWV3LnJhdGluZyA9PT0gNSA/ICdncmVlbicgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZpZXcucmF0aW5nID4gMiA/ICdvcmFuZ2UnIDogJ3JlZCc7XHJcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcclxuXHJcbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xyXG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcclxuXHJcbiAgY29uc3QgbGFiZWwgPSBgJHtyZXZpZXcubmFtZX0gc2FpZCAke3Jldmlldy5jb21tZW50c30gYW5kIHJhdGVkIHRoZSByZXN0YXVyYW50ICR7cmV2aWV3LnJhdGluZ30gb3V0IG9mIDVgO1xyXG4gIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGxhYmVsKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIFRNUCByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuY3JlYXRlVG1wUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbGkuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0bXAnKTtcclxuICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBkaXYuc2V0QXR0cmlidXRlKCdjbGFzcycsICdyZXZpZXctaGVhZGVyJyk7XHJcbiAgbGkuYXBwZW5kQ2hpbGQoZGl2KTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gxJyk7XHJcbiAgbmFtZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3Jldmlld05hbWUnKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xyXG4gIGRpdi5hcHBlbmRDaGlsZChuYW1lKTtcclxuXHJcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2g1Jyk7XHJcbiAgZGF0ZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3Jldmlld0RhdGUnKTtcclxuICBjb25zdCBkYXRlT3B0aW9ucyA9IHsgd2Vla2RheTogJ2xvbmcnLCB5ZWFyOiAnbnVtZXJpYycsIG1vbnRoOiAnbG9uZycsIGRheTogJ251bWVyaWMnIH07XHJcbiAgZGF0ZS5pbm5lckhUTUwgPSAobmV3IERhdGUocmV2aWV3LmNyZWF0ZWRBdCkpLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tVVMnLCBkYXRlT3B0aW9ucyk7XHJcbiAgZGl2LmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XHJcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gO1xyXG4gIHJhdGluZy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3Jldmlld1JhdGluZycpO1xyXG4gIHJhdGluZy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSByZXZpZXcucmF0aW5nID09PSA1ID8gJ2dyZWVuJyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmlldy5yYXRpbmcgPiAyID8gJ29yYW5nZScgOiAncmVkJztcclxuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xyXG5cclxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XHJcbiAgY29tbWVudHMuc2V0QXR0cmlidXRlKCdjbGFzcycsICdyZXZpZXdDb21tZW50Jyk7XHJcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xyXG5cclxuICByZXR1cm4gbGk7XHJcbn07XHJcblxyXG4vKipcclxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcclxuICovXHJcbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQ9c2VsZi5yZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XHJcblx0Y29uc3QgYnJlYWRjcnVtYkVsZW1lbnRzID0gYnJlYWRjcnVtYi5xdWVyeVNlbGVjdG9yQWxsKCdsaScpO1xyXG5cdGZvciAoZWxlbWVudCBvZiBicmVhZGNydW1iRWxlbWVudHMpIHtcclxuXHRlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jdXJyZW50Jyk7XHJcbn1cclxuXHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcblx0bGkuc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCAncGFnZScpO1xyXG5cdGlmIChicmVhZGNydW1iLmNoaWxkRWxlbWVudENvdW50ID09PSAyKSByZXR1cm47XHJcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cclxuICovXHJcbmdldFBhcmFtZXRlckJ5TmFtZSA9IChuYW1lLCB1cmwpID0+IHtcclxuICBpZiAoIXVybClcclxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xyXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtcXF1dL2csICdcXFxcJCYnKTtcclxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcclxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XHJcbiAgaWYgKCFyZXN1bHRzKVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgaWYgKCFyZXN1bHRzWzJdKVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XHJcbn1cclxuXHJcbi8vZXZlbnRsaXN0ZW5lcnMgZm9yIGZhdm9yaXRlIHRvZ2dsZVxyXG5cclxuY29uc3QgZmF2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lzRmF2b3JpdGUnKTtcclxuZmF2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIHRvZ2dsZUZhdm9yaXRlKHNlbGYucmVzdGF1cmFudC5pZCk7XHJcbn0pO1xyXG5mYXYuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHsgLy8gPSBlbnRlciBrZXlcclxuICAgIHRvZ2dsZUZhdm9yaXRlKHNlbGYucmVzdGF1cmFudC5pZCk7XHJcbiAgfVxyXG59KTtcclxuXHJcblxyXG5pZiAobmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIpIHtcclxuICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcignc3cuanMnKVxyXG4gICAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coJ1Bhc3NlZCBUZXN0JykpXHJcbn07XHJcbiIsIlxyXG4vKipcclxuICogUmVnaXN0ZXIgYSBzZXJ2aWNlV29ya2VyXHJcbiAqL1xyXG5yZWdpc3RlclNlcnZpY2VXb3JrZXIgPSAoKSA9PiB7XHJcbiAgICAvL2NoZWNrIGlmIHNlcnZpY2VXb3JrZXIgaXMgc3VwcG9ydGVkLCBvdGhlcndpc2UgcmV0dXJuXHJcbiAgICBpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSByZXR1cm47XHJcblxyXG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy9zdy5qcycpLmNhdGNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiU29tZXRoaW5nIHdlbnQgd3JvbmcuIFNlcnZpY2VXb3JrZXIgbm90IHJlZ2lzdGVyZWRcIik7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICByZWdpc3RlclNlcnZpY2VXb3JrZXIoKTtcclxuIiwiLypjcmVkdGl0IG9mIHRoZSBvcmlnaW5hbCBjb2RlIGZvciB0aGlzIGZyb20gZ29lcyB0b1xyXG4qIHVzZXIgJ2dyZWdoJyBmcm9tIGNvZGVwZW5cclxuKihodHRwczovL2NvZGVwZW4uaW8vZ3JlZ2gvcGVuL3JqYm1YYilcclxuKiBJIGp1c3QgdHdlYWtlZCBpdCB0byBzdWl0IHRoaXMgYXBwbGljYXRpb24ncyBuZWVkcyovXHJcblxyXG52YXIgdnVlID0gbmV3IFZ1ZSh7XHJcbiAgZWw6ICcjYXBwJyxcclxuICBkYXRhOiB7XHJcbiAgICBmb3JtT3BlbjogZmFsc2UsXHJcbiAgICByZXZpZXc6IHtcclxuICAgICAgbmFtZTogJycsXHJcbiAgICAgIHJhdGluZzogJycsXHJcbiAgICAgIGNvbW1lbnRzOicnXHJcbiAgICB9XHJcbiAgfSxcclxuICBtZXRob2RzOiB7XHJcbiAgICByZXNldEZvcm06IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5yZXZpZXcgPSB7XHJcbiAgICAgICAgbmFtZTogJycsXHJcbiAgICAgICAgcmF0aW5nOiAnJyxcclxuICAgICAgICBjb21tZW50czonJ1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2FuY2VsOiBmdW5jdGlvbigpIHtcclxuICAgICAgdGhpcy5mb3JtT3BlbiA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnJlc2V0Rm9ybSgpO1xyXG4gICAgfVxyXG4gIH1cclxufSlcclxuXHJcbi8qKlxyXG4gKiBIYW5sZGluZyBmb3JtIHN1Ym1pdGlvblxyXG4gKi9cclxuIGFkZFJldmlldyA9ICgpID0+IHtcclxuICAgY29uc3QgcmV2aWV3ID0ge1xyXG4gICAgcmVzdGF1cmFudF9pZDogc2VsZi5yZXN0YXVyYW50LmlkLFxyXG4gICAgbmFtZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZSxcclxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgcmF0aW5nOiArZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhdGluZycpLnZhbHVlLFxyXG4gICAgY29tbWVudHM6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21tZW50cycpLnZhbHVlLFxyXG4gIH07XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XHJcbiAgdWwuaW5zZXJ0QmVmb3JlKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSwgdWwuY2hpbGROb2Rlc1swXSk7XHJcbiAgaWYgKCFuYXZpZ2F0b3Iub25MaW5lKSB7XHJcbiAgICBhbGVydCgnWW91IGFyZSBjdXJyZW50bHkgb2ZmbGluZS4gWW91ciByZXZpZXcgd2lsbCBiZSBwb3N0ZWQgb25jZSB5b3UgYXJlIG9ubGluZSBhZ2Fpbi4gVGhhbmsgeW91IGZvciByZXZpZXdpbmchJyk7XHJcbiAgfVxyXG4gIERCSGVscGVyLnBvc3RSZXZpZXcocmV2aWV3KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWFkeS50aGVuKGZ1bmN0aW9uIChyZWdzdykge1xyXG4gICAgcmVnc3cuc3luYy5yZWdpc3RlcigncmVxUmV2aWV3U3luYycpO1xyXG4gICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgfSk7XHJcbn0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gIGZpbGxSZXZpZXdzSFRNTCgpO1xyXG59KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICBvZmZsaW5lUmV2aWV3c0hUTUwoKTtcclxufSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxufSk7XHJcbn07XHJcblxyXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3LWZvcm0nKS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGFkZFJldmlldygpO1xyXG4gIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1Ym1pdCcpLmNsaWNrKCk7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVcIikudGFiSW5kZXggPSAnLTEnO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyYXRpbmdcIikudGFiSW5kZXggPSAnLTEnO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50c1wiKS50YWJJbmRleCA9ICctMSc7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Ym1pdFwiKS50YWJJbmRleCA9ICctMSc7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbmNlbFwiKS50YWJJbmRleCA9ICctMSc7XHJcbiAgfVxyXG5cclxufSk7XHJcblxyXG5cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtcmV2aWV3XCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVcIikudGFiSW5kZXggPSAnMCc7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJhdGluZ1wiKS50YWJJbmRleCA9ICcwJztcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29tbWVudHNcIikudGFiSW5kZXggPSAnMCc7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Ym1pdFwiKS50YWJJbmRleCA9ICcwJztcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuY2VsXCIpLnRhYkluZGV4ID0gJzAnO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtcmV2aWV3XCIpLmNsaWNrKCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwnKS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWwnKS5jbGljaygpO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lXCIpLnRhYkluZGV4ID0gJy0xJztcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmF0aW5nXCIpLnRhYkluZGV4ID0gJy0xJztcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29tbWVudHNcIikudGFiSW5kZXggPSAnLTEnO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWJtaXRcIikudGFiSW5kZXggPSAnLTEnO1xyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWxcIikudGFiSW5kZXggPSAnLTEnO1xyXG4gIH1cclxufSk7XHJcbiJdfQ==
